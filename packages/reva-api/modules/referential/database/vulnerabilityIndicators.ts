import { Either, Left, Right } from "purify-ts";

import { prismaClient } from "../../../infra/database/postgres/client";
import { logger } from "../../../infra/logger";
import { VulnerabilityIndicator } from "../referential.types";

export const getVulnerabilityIndicators = async (): Promise<
  Either<string, VulnerabilityIndicator[]>
> => {
  try {
    const vulnerabilityIndicators =
      await prismaClient.vulnerabilityIndicator.findMany();

    return Right(vulnerabilityIndicators);
  } catch (e) {
    logger.error(e);
    return Left(`error while retrieving vulnerability indicators`);
  }
};
